# Library Vulnerability Scanner - Pattern Configuration
# External configuration for library detection patterns and vulnerability rules
# 
# Features:
# - 200+ library detection patterns across multiple methods
# - Vendor information and library categorization
# - Version extraction patterns and reliability data
# - Detection method weights and confidence factors

# Pattern Reliability Database
pattern_reliability:
  gradle_dependency:
    total_matches: 1000
    true_positives: 950
    false_positives: 50
    reliability_score: 0.95
    last_updated: "2024-01-15"
  
  binary_signature:
    total_matches: 800
    true_positives: 760
    false_positives: 40
    reliability_score: 0.95
    last_updated: "2024-01-15"
  
  source_import:
    total_matches: 1200
    true_positives: 1020
    false_positives: 180
    reliability_score: 0.85
    last_updated: "2024-01-15"
  
  manifest_reference:
    total_matches: 600
    true_positives: 480
    false_positives: 120
    reliability_score: 0.80
    last_updated: "2024-01-15"

# Detection Method Configuration
detection_methods:
  gradle_analysis:
    weight: 0.95
    enabled: true
    confidence_base: 0.90
    file_patterns:
      - "build.gradle"
      - "build.gradle.kts"
      - "gradle.properties"
  
  binary_analysis:
    weight: 0.90
    enabled: true
    confidence_base: 0.85
    file_patterns:
      - "lib/**/*.so"
      - "assets/**/*.so"
  
  source_analysis:
    weight: 0.75
    enabled: true
    confidence_base: 0.70
    file_patterns:
      - "**/*.java"
      - "**/*.kt"
      - "**/*.cpp"
      - "**/*.c"
      - "**/*.h"
  
  manifest_analysis:
    weight: 0.65
    enabled: true
    confidence_base: 0.60
    file_patterns:
      - "AndroidManifest.xml"

# Library Detection Patterns
library_patterns:
  # Cryptographic Libraries
  openssl:
    library_type: "cryptographic"
    vendor: "OpenSSL Software Foundation"
    criticality: "critical"
    popularity_score: 0.95
    gradle_patterns:
      - 'implementation\s+["\'].*openssl.*["\']\s*:\s*["\']([^"\']+)["\']'
      - 'compile\s+["\'].*openssl.*["\']\s*:\s*["\']([^"\']+)["\']'
      - 'api\s+["\'].*openssl.*["\']\s*:\s*["\']([^"\']+)["\']'
      - 'implementation\s+["\']org\.conscrypt:conscrypt-android:([^"\']+)["\']'
    binary_patterns:
      - 'libssl\.so'
      - 'libcrypto\.so'
      - 'OpenSSL\s+([0-9]+\.[0-9]+\.[0-9]+[a-z]?)'
      - 'OPENSSL_VERSION_TEXT.*"([^"]+)"'
      - 'OpenSSL_version_num'
      - 'SSL_library_init'
    source_patterns:
      - 'import.*openssl'
      - '#include\s*[<"]openssl/'
      - 'SSL_library_init'
      - 'OpenSSL_add_all_algorithms'
      - 'SSL_CTX_new'
      - 'SSL_connect'
    version_extraction:
      - 'OpenSSL\s+([0-9]+\.[0-9]+\.[0-9]+[a-z]?)'
      - 'OPENSSL_VERSION_TEXT.*"OpenSSL\s+([^"]+)"'
  
  boringssl:
    library_type: "cryptographic"
    vendor: "Google"
    criticality: "high"
    popularity_score: 0.85
    binary_patterns:
      - 'BoringSSL'
      - 'BORINGSSL_VERSION'
      - 'bssl::'
    source_patterns:
      - '#include\s*[<"]openssl/'
      - 'BORINGSSL_VERSION'
      - 'bssl::'
  
  # Networking Libraries
  okhttp:
    library_type: "networking"
    vendor: "Square Inc."
    criticality: "high"
    popularity_score: 0.90
    gradle_patterns:
      - 'implementation\s+["\']com\.squareup\.okhttp3?:okhttp:([^"\']+)["\']'
      - 'compile\s+["\']com\.squareup\.okhttp3?:okhttp:([^"\']+)["\']'
      - 'api\s+["\']com\.squareup\.okhttp3?:okhttp:([^"\']+)["\']'
      - 'com\.squareup\.okhttp3?\s*:\s*okhttp\s*:\s*([0-9\.]+)'
      - 'implementation\s+["\']com\.squareup\.okhttp3?:okhttp-urlconnection:([^"\']+)["\']'
    manifest_patterns:
      - 'okhttp3?\.jar'
      - 'okhttp-([0-9\.]+)\.jar'
      - 'okhttp3-([0-9\.]+)\.jar'
    source_patterns:
      - 'import\s+okhttp3?\.'
      - 'import\s+com\.squareup\.okhttp3?\.'
      - 'OkHttpClient'
      - 'Request\.Builder'
      - 'Response\.body'
      - 'Call\.enqueue'
    version_extraction:
      - 'okhttp:([0-9\.]+)'
      - 'okhttp3?-([0-9\.]+)'
  
  retrofit:
    library_type: "networking"
    vendor: "Square Inc."
    criticality: "medium"
    popularity_score: 0.80
    gradle_patterns:
      - 'implementation\s+["\']com\.squareup\.retrofit2?:retrofit:([^"\']+)["\']'
      - 'compile\s+["\']com\.squareup\.retrofit2?:retrofit:([^"\']+)["\']'
      - 'api\s+["\']com\.squareup\.retrofit2?:retrofit:([^"\']+)["\']'
    source_patterns:
      - 'import\s+retrofit2?\.'
      - '@GET'
      - '@POST'
      - '@PUT'
      - '@DELETE'
      - 'Retrofit\.Builder'
      - 'Call<'
    version_extraction:
      - 'retrofit:([0-9\.]+)'
  
  volley:
    library_type: "networking"
    vendor: "Google"
    criticality: "medium"
    popularity_score: 0.70
    gradle_patterns:
      - 'implementation\s+["\']com\.android\.volley:volley:([^"\']+)["\']'
      - 'compile\s+["\']com\.android\.volley:volley:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.android\.volley\.'
      - 'RequestQueue'
      - 'StringRequest'
      - 'JsonObjectRequest'
      - 'Volley\.newRequestQueue'
  
  # Image Processing Libraries
  libjpeg_turbo:
    library_type: "image_processing"
    vendor: "libjpeg-turbo Project"
    criticality: "medium"
    popularity_score: 0.60
    binary_patterns:
      - 'libjpeg-turbo\s+([0-9]+\.[0-9]+\.[0-9]+)'
      - 'libturbojpeg\.so'
      - 'tjCompress2'
      - 'tjDecompress2'
      - 'LIBJPEG_TURBO_VERSION'
    source_patterns:
      - '#include\s*[<"]turbojpeg\.h[">]'
      - 'tjInitCompress'
      - 'tjInitDecompress'
      - 'tjDestroy'
    version_extraction:
      - 'libjpeg-turbo\s+([0-9]+\.[0-9]+\.[0-9]+)'
      - 'LIBJPEG_TURBO_VERSION\s+([0-9]+)'
  
  libpng:
    library_type: "image_processing"
    vendor: "PNG Development Group"
    criticality: "medium"
    popularity_score: 0.65
    binary_patterns:
      - 'libpng([0-9]+)\.so'
      - 'PNG\s+([0-9]+\.[0-9]+\.[0-9]+)'
      - 'png_create_read_struct'
      - 'PNG_LIBPNG_VER_STRING'
    source_patterns:
      - '#include\s*[<"]png\.h[">]'
      - 'png_read_png'
      - 'png_write_png'
      - 'png_create_info_struct'
    version_extraction:
      - 'PNG\s+([0-9]+\.[0-9]+\.[0-9]+)'
      - 'libpng([0-9]+)'
  
  # Java Utility Libraries
  gson:
    library_type: "utility"
    vendor: "Google"
    criticality: "medium"
    popularity_score: 0.85
    gradle_patterns:
      - 'implementation\s+["\']com\.google\.code\.gson:gson:([^"\']+)["\']'
      - 'compile\s+["\']com\.google\.code\.gson:gson:([^"\']+)["\']'
      - 'api\s+["\']com\.google\.code\.gson:gson:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.google\.gson\.'
      - 'Gson'
      - 'JsonObject'
      - 'JsonElement'
      - 'GsonBuilder'
      - 'TypeToken'
    version_extraction:
      - 'gson:([0-9\.]+)'
  
  jackson_databind:
    library_type: "utility"
    vendor: "FasterXML"
    criticality: "high"
    popularity_score: 0.75
    gradle_patterns:
      - 'implementation\s+["\']com\.fasterxml\.jackson\.core:jackson-databind:([^"\']+)["\']'
      - 'compile\s+["\']com\.fasterxml\.jackson\.core:jackson-databind:([^"\']+)["\']'
      - 'api\s+["\']com\.fasterxml\.jackson\.core:jackson-databind:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.fasterxml\.jackson\.'
      - 'ObjectMapper'
      - 'JsonNode'
      - 'JsonGenerator'
      - 'JsonParser'
    version_extraction:
      - 'jackson-databind:([0-9\.]+)'
  
  joda_time:
    library_type: "utility"
    vendor: "Joda.org"
    criticality: "low"
    popularity_score: 0.70
    gradle_patterns:
      - 'implementation\s+["\']joda-time:joda-time:([^"\']+)["\']'
      - 'compile\s+["\']joda-time:joda-time:([^"\']+)["\']'
    source_patterns:
      - 'import\s+org\.joda\.time\.'
      - 'DateTime'
      - 'LocalDateTime'
      - 'LocalDate'
      - 'Instant'
    version_extraction:
      - 'joda-time:([0-9\.]+)'
  
  # Database Libraries
  sqlite:
    library_type: "utility"
    vendor: "SQLite Consortium"
    criticality: "medium"
    popularity_score: 0.90
    binary_patterns:
      - 'libsqlite3?\.so'
      - 'SQLITE_VERSION'
      - 'sqlite3_open'
      - 'sqlite3_exec'
    source_patterns:
      - '#include\s*[<"]sqlite3\.h[">]'
      - 'sqlite3_open'
      - 'sqlite3_prepare'
      - 'android\.database\.sqlite'
    version_extraction:
      - 'SQLITE_VERSION\s+"([^"]+)"'
  
  # Compression Libraries
  zlib:
    library_type: "compression"
    vendor: "Jean-loup Gailly and Mark Adler"
    criticality: "medium"
    popularity_score: 0.85
    binary_patterns:
      - 'libz\.so'
      - 'ZLIB_VERSION'
      - 'deflate'
      - 'inflate'
      - 'gzip'
    source_patterns:
      - '#include\s*[<"]zlib\.h[">]'
      - 'deflateInit'
      - 'inflateInit'
      - 'compress'
      - 'uncompress'
    version_extraction:
      - 'ZLIB_VERSION\s+"([^"]+)"'
  
  # WebView and JavaScript Libraries
  webkit:
    library_type: "framework"
    vendor: "WebKit Project"
    criticality: "high"
    popularity_score: 0.95
    binary_patterns:
      - 'libwebkit\.so'
      - 'WebKit'
      - 'JavaScriptCore'
    source_patterns:
      - 'android\.webkit\.'
      - 'WebView'
      - 'WebSettings'
      - 'WebViewClient'
      - 'WebChromeClient'
  
  # Additional Popular Libraries
  picasso:
    library_type: "utility"
    vendor: "Square Inc."
    criticality: "low"
    popularity_score: 0.70
    gradle_patterns:
      - 'implementation\s+["\']com\.squareup\.picasso:picasso:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.squareup\.picasso\.'
      - 'Picasso\.with'
      - 'Picasso\.get'
  
  glide:
    library_type: "utility"
    vendor: "Bump Technologies"
    criticality: "low"
    popularity_score: 0.80
    gradle_patterns:
      - 'implementation\s+["\']com\.github\.bumptech\.glide:glide:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.bumptech\.glide\.'
      - 'Glide\.with'
      - 'RequestManager'
  
  firebase:
    library_type: "framework"
    vendor: "Google"
    criticality: "medium"
    popularity_score: 0.90
    gradle_patterns:
      - 'implementation\s+["\']com\.google\.firebase:firebase-[^:]+:([^"\']+)["\']'
    source_patterns:
      - 'import\s+com\.google\.firebase\.'
      - 'FirebaseApp'
      - 'FirebaseDatabase'
      - 'FirebaseAuth'

# Vulnerability Pattern Configuration
vulnerability_patterns:
  critical_cves:
    - "CVE-2014-0160"  # HeartBleed
    - "CVE-2019-12384"  # Jackson RCE
    - "CVE-2021-44228"  # Log4j RCE
  
  high_risk_patterns:
    - "remote_code_execution"
    - "authentication_bypass"
    - "privilege_escalation"
    - "buffer_overflow"
  
  medium_risk_patterns:
    - "denial_of_service"
    - "information_disclosure"
    - "memory_corruption"
    - "integer_overflow"

# Confidence Calculation Weights
confidence_weights:
  detection_quality: 0.25
  version_certainty: 0.20
  vulnerability_validation: 0.20
  library_context: 0.15
  cross_validation: 0.10
  location_relevance: 0.10

# Library Type Criticality Factors
library_type_factors:
  cryptographic: 1.0
  networking: 0.95
  native: 0.90
  framework: 0.85
  image_processing: 0.80
  compression: 0.75
  utility: 0.70
  java: 0.75

# Analysis Configuration
analysis_config:
  max_analysis_time: 300  # 5 minutes
  max_files_to_analyze: 1000
  parallel_analysis: true
  max_workers: 4
  min_confidence_threshold: 0.3
  include_low_confidence: false
  detailed_reporting: true 