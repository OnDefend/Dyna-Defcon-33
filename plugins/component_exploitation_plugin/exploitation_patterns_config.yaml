# Component Exploitation Plugin - External Configuration
# Exploitation patterns, command templates, and security assessment rules

# Component Risk Assessment Patterns
component_risk_patterns:
  critical_risk:
    - exported: true
      permissions: []
      intent_filters_present: true
      description: "Exported component with no permission protection and intent filters"
    - exported: true
      dangerous_permissions: true
      permission_level: "dangerous"
      description: "Exported component with dangerous permissions"
    
  high_risk:
    - exported: true
      permissions: []
      description: "Exported component with no permission protection"
    - exported: true
      custom_permissions: true
      permission_level: "signature"
      description: "Exported component with weak custom permissions"
    
  medium_risk:
    - exported: true
      permissions: ["normal"]
      description: "Exported component with normal permissions only"
    - exported: false
      dynamic_registration: true
      description: "Component with dynamic broadcast registration"
    
  low_risk:
    - exported: true
      permissions: ["signature", "signatureOrSystem"]
      description: "Exported component with signature-level permissions"
    - exported: false
      permissions: []
      description: "Non-exported component"

# ADB Command Templates for Component Exploitation
exploitation_commands:
  activity:
    basic_launch: "adb shell am start -n {package}/{component}"
    with_extras_string: "adb shell am start -n {package}/{component} --es {key} {value}"
    with_extras_int: "adb shell am start -n {package}/{component} --ei {key} {value}"
    with_extras_bool: "adb shell am start -n {package}/{component} --ez {key} {value}"
    with_uri: "adb shell am start -n {package}/{component} -d {uri}"
    with_action: "adb shell am start -a {action} -n {package}/{component}"
    
  service:
    start_service: "adb shell am startservice -n {package}/{component}"
    start_with_extras: "adb shell am startservice -n {package}/{component} --es {key} {value}"
    start_with_action: "adb shell am startservice -a {action} -n {package}/{component}"
    stop_service: "adb shell am stopservice -n {package}/{component}"
    
  receiver:
    send_broadcast: "adb shell am broadcast -a {action} -n {package}/{component}"
    send_with_extras: "adb shell am broadcast -a {action} -n {package}/{component} --es {key} {value}"
    send_with_data: "adb shell am broadcast -a {action} -d {data} -n {package}/{component}"
    
  provider:
    query_content: "adb shell content query --uri content://{authority}"
    query_with_projection: "adb shell content query --uri content://{authority} --projection {columns}"
    query_with_where: "adb shell content query --uri content://{authority} --where {condition}"
    insert_content: "adb shell content insert --uri content://{authority} --bind {data}"

# Security Assessment Scoring Rules
security_scoring:
  grade_thresholds:
    A_PLUS: 95
    A: 85
    B: 75
    C: 65
    D: 50
    F: 0
    
  risk_weights:
    critical: -25
    high: -15
    medium: -8
    low: -3
    minimal: 0
    
  component_type_weights:
    activity: 1.0
    service: 1.2
    receiver: 1.1
    provider: 1.3
    
  protection_bonuses:
    signature_permission: 15
    dangerous_permission_protected: 10
    custom_permission: 5
    intent_filter_restricted: 8

# Command Safety Assessment Rules
command_safety:
  safe_patterns:
    - "am start.*-n.*\\.MainActivity"
    - "am start.*--es test"
    - "content query.*--projection"
    
  caution_patterns:
    - "am start.*--es.*password"
    - "am broadcast.*private"
    - "content insert"
    
  dangerous_patterns:
    - "am start.*--es.*admin"
    - "am broadcast.*BOOT_COMPLETED"
    - "content query.*--where.*password"

# OWASP MASVS Category Mappings
owasp_mappings:
  activity:
    category: "MSTG-PLATFORM-11"
    title: "App Testing Authorization and Authentication"
    description: "Exported activities without proper authentication"
    
  service:
    category: "MSTG-PLATFORM-8"
    title: "App Testing Object Persistence"
    description: "Exported services allowing unauthorized access"
    
  receiver:
    category: "MSTG-PLATFORM-11"
    title: "App Testing Authorization and Authentication"
    description: "Broadcast receivers without permission protection"
    
  provider:
    category: "MSTG-PLATFORM-2"
    title: "App Testing Data Storage"
    description: "Content providers exposing sensitive data"

# CWE (Common Weakness Enumeration) Mappings
cwe_mappings:
  exported_without_permission:
    id: "CWE-284"
    name: "Improper Access Control"
    description: "Component exported without proper access controls"
    
  information_exposure:
    id: "CWE-200" 
    name: "Information Exposure"
    description: "Component may expose sensitive information"
    
  missing_authentication:
    id: "CWE-306"
    name: "Missing Authentication for Critical Function"
    description: "Critical component lacks authentication mechanisms"
    
  privilege_escalation:
    id: "CWE-269"
    name: "Improper Privilege Management"
    description: "Component allows privilege escalation attacks"

# Security Recommendations Templates
recommendations:
  critical:
    - "Immediately add signature-level permissions to all exported components"
    - "Implement robust input validation for all component entry points"
    - "Review and restrict dangerous permission usage across components"
    
  high:
    - "Add permission protection to exported components"
    - "Implement proper authentication for sensitive operations"
    - "Audit component exposure and minimize attack surface"
    
  medium:
    - "Review component permission requirements"
    - "Implement input sanitization for component parameters"
    - "Add logging and monitoring for component access"
    
  general:
    - "Follow Android security best practices for component design"
    - "Regularly audit component exposure and permissions"
    - "Implement defense-in-depth security controls"

# Threat Assessment Criteria
threat_assessment:
  critical_indicators:
    - exploitable_count_threshold: 5
    - high_risk_percentage: 0.5
    - dangerous_permissions_exposed: true
    
  high_indicators:
    - exploitable_count_threshold: 3
    - high_risk_percentage: 0.3
    - sensitive_data_exposure: true
    
  medium_indicators:
    - exploitable_count_threshold: 1
    - high_risk_percentage: 0.1
    - permission_bypass_possible: true

# Component Analysis Configuration
analysis_config:
  max_commands_per_component: 10
  max_findings_to_report: 50
  enable_dynamic_testing: true
  include_low_risk_findings: false
  detailed_evidence_collection: true
  
  # Pattern reliability for confidence calculation
  pattern_reliability:
    explicit_export: 0.95
    permission_analysis: 0.90
    intent_filter_analysis: 0.85
    manifest_parsing: 0.92
    component_discovery: 0.88 