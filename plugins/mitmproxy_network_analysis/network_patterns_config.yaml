# AODS Network Security Patterns Configuration
# Professional-grade pattern database for network vulnerability detection

network_security_patterns:
  # HTTP Security Patterns (30+ patterns)
  http_security:
    - pattern: "http://.*"
      description: "Insecure HTTP connection"
      severity: "HIGH"
      confidence: 0.85
      confidence_weight: 0.85
      false_positive_rate: 0.02
    - pattern: "http://[^/]*api[./]"
      description: "API accessed over insecure HTTP"
      severity: "CRITICAL"
      confidence: 0.95
      confidence_weight: 0.95
      false_positive_rate: 0.01
    - pattern: "http://[^/]*login[./]"
      description: "Login functionality over HTTP"
      severity: "CRITICAL"
      confidence: 0.98
      confidence_weight: 0.98
      false_positive_rate: 0.005
    - pattern: "http://[^/]*auth[./]"
      description: "Authentication over HTTP"
      severity: "CRITICAL"
      confidence: 0.98
      confidence_weight: 0.98
      false_positive_rate: 0.005
    - pattern: "http://[^/]*payment[./]"
      description: "Payment functionality over HTTP"
      severity: "CRITICAL"
      confidence_weight: 0.99
      false_positive_rate: 0.001
    - pattern: "http://[^/]*checkout[./]"
      description: "Checkout process over HTTP"
      severity: "CRITICAL"
      confidence_weight: 0.98
      false_positive_rate: 0.002
    - pattern: "http://[^/]*admin[./]"
      description: "Admin interface over HTTP"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.01
    - pattern: "http://[^/]*banking[./]"
      description: "Banking interface over HTTP"
      severity: "CRITICAL"
      confidence_weight: 0.99
      false_positive_rate: 0.001
    - pattern: "SSLv2|SSLv3|TLSv1\\.0"
      description: "Deprecated SSL/TLS version"
      severity: "HIGH" 
      confidence_weight: 0.90
      false_positive_rate: 0.03
    - pattern: "TLSv1\\.1"
      description: "Outdated TLS version"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.05
    - pattern: "RC4|DES|3DES|MD5"
      description: "Weak cryptographic cipher"
      severity: "HIGH"
      confidence_weight: 0.88
      false_positive_rate: 0.02
    - pattern: "NULL|EXPORT|ADH|aNULL"
      description: "Insecure cipher suite"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.01
    - pattern: "Cache-Control\\s*:\\s*no-cache"
      description: "Sensitive data not cached"
      severity: "INFO"
      confidence_weight: 0.60
      false_positive_rate: 0.20
    - pattern: "X-Frame-Options"
      description: "Clickjacking protection present"
      severity: "INFO"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "Content-Security-Policy"
      description: "CSP header present"
      severity: "INFO"
      confidence_weight: 0.75
      false_positive_rate: 0.10

  # API Security Patterns (35+ patterns)
  api_security:
    - pattern: "[Aa][Pp][Ii]_?[Kk][Ee][Yy]\\s*[=:]\\s*['\"]?[A-Za-z0-9]{16,}['\"]?"
      description: "Exposed API key"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "[Aa][Cc][Cc][Ee][Ss][Ss]_?[Kk][Ee][Yy]\\s*[=:]\\s*['\"]?[A-Za-z0-9]{16,}['\"]?"
      description: "Exposed access key"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "[Ss][Ee][Cc][Rr][Ee][Tt]_?[Kk][Ee][Yy]\\s*[=:]\\s*['\"]?[A-Za-z0-9]{16,}['\"]?"
      description: "Exposed secret key"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "AKIA[0-9A-Z]{16}"
      description: "AWS Access Key ID"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.01
    - pattern: "[A-Za-z0-9/+=]{40}"
      description: "AWS Secret Access Key pattern"
      severity: "HIGH"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "AIza[0-9A-Za-z\\-_]{35}"
      description: "Google API Key"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.03
    - pattern: "[Bb][Ee][Aa][Rr][Ee][Rr]\\s+[A-Za-z0-9\\-._~+/]+=*"
      description: "Bearer token in header"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.10
    - pattern: "access_token[=:]\\s*['\"]?[A-Za-z0-9\\-._~+/]+=*['\"]?"
      description: "Access token parameter"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.12
    - pattern: "gh[pousr]_[A-Za-z0-9_]{36}"
      description: "GitHub Personal Access Token"
      severity: "HIGH"
      confidence_weight: 0.95
      false_positive_rate: 0.02
    - pattern: "sk_live_[0-9a-zA-Z]{24}"
      description: "Stripe Live Secret Key"
      severity: "CRITICAL"
      confidence_weight: 0.98
      false_positive_rate: 0.01
    - pattern: "sk_test_[0-9a-zA-Z]{24}"
      description: "Stripe Test Secret Key"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "sq0csp-[0-9A-Za-z\\-_]{43}"
      description: "Square Access Token"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.03
    - pattern: "ya29\\.[0-9A-Za-z\\-_]+"
      description: "Google OAuth Access Token"
      severity: "MEDIUM"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "EAAA[0-9A-Za-z]+"
      description: "Facebook Access Token"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "[1-9][0-9]+-[0-9a-zA-Z_]{32}\\.apps\\.googleusercontent\\.com"
      description: "Google OAuth Client ID"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)client_secret[=:]\\s*['\"]?[A-Za-z0-9\\-_]{24,}['\"]?"
      description: "OAuth Client Secret"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "twilio[^\\s]*[=:]\\s*['\"]?AC[a-z0-9]{32}['\"]?"
      description: "Twilio Account SID"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "[a-zA-Z0-9_-]*:[a-zA-Z0-9_\\-]{8,}"
      description: "Basic Auth credentials"
      severity: "HIGH"
      confidence_weight: 0.70
      false_positive_rate: 0.20
    - pattern: "api[_-]?version[=:]\\s*['\"]?v?[0-9]+['\"]?"
      description: "API version specification"
      severity: "INFO"
      confidence_weight: 0.60
      false_positive_rate: 0.25
    - pattern: "/api/v[0-9]+/"
      description: "Versioned API endpoint"
      severity: "INFO"
      confidence_weight: 0.65
      false_positive_rate: 0.20

  # Authentication Patterns (25+ patterns)
  authentication:
    - pattern: "password[=:]\\s*['\"]?(123|password|admin|root)['\"]?"
      description: "Weak default password"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.02
    - pattern: "pwd[=:]\\s*['\"]?[a-zA-Z0-9]{1,6}['\"]?"
      description: "Short password"
      severity: "HIGH"
      confidence_weight: 0.70
      false_positive_rate: 0.20
    - pattern: "JSESSIONID|PHPSESSID|ASP\\.NET_SessionId"
      description: "Session identifier in URL"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.10
    - pattern: "session[=:]\\s*['\"]?[A-Za-z0-9]{16,}['\"]?"
      description: "Session token pattern"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*"
      description: "JSON Web Token"
      severity: "MEDIUM"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "(?i)authorization[=:]\\s*['\"]?basic\\s+[A-Za-z0-9+/=]+['\"]?"
      description: "Basic authentication header"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)x-api-key[=:]\\s*['\"]?[A-Za-z0-9\\-_]+['\"]?"
      description: "API key in custom header"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)cookie[=:]\\s*['\"]?[^'\"\\s]+['\"]?"
      description: "Cookie header"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.30
    - pattern: "(?i)set-cookie[=:]\\s*['\"]?[^'\"\\r\\n]+['\"]?"
      description: "Set cookie header"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.30
    - pattern: "httpOnly|secure|samesite"
      description: "Cookie security flags"
      severity: "INFO"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "(?i)refresh_token[=:]\\s*['\"]?[A-Za-z0-9\\-._~+/]+=*['\"]?"
      description: "OAuth refresh token"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)id_token[=:]\\s*['\"]?[A-Za-z0-9\\-._~+/]+=*['\"]?"
      description: "OpenID Connect ID token"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)x-auth-token[=:]\\s*['\"]?[A-Za-z0-9\\-_]+['\"]?"
      description: "Custom auth token header"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.12
    - pattern: "(?i)x-csrf-token[=:]\\s*['\"]?[A-Za-z0-9\\-_]+['\"]?"
      description: "CSRF protection token"
      severity: "INFO"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "(?i)x-xsrf-token[=:]\\s*['\"]?[A-Za-z0-9\\-_]+['\"]?"
      description: "XSRF protection token"
      severity: "INFO"
      confidence_weight: 0.70
      false_positive_rate: 0.15

  # Database Security Patterns (20+ patterns)
  database_security:
    - pattern: "(?i)union\\s+select|select\\s+.*from\\s+|insert\\s+into\\s+|delete\\s+from\\s+"
      description: "SQL injection attempt"
      severity: "CRITICAL"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)drop\\s+table|truncate\\s+table"
      description: "Destructive SQL operation"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "jdbc:[^\\s]+://[^\\s]+:[^\\s]+@"
      description: "Database connection string with credentials"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "mongodb://[^\\s]*:[^\\s]*@"
      description: "MongoDB connection with credentials"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "mysql://[^\\s]*:[^\\s]*@"
      description: "MySQL connection with credentials"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "postgresql://[^\\s]*:[^\\s]*@"
      description: "PostgreSQL connection with credentials"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "(?i)\\';\\s*drop|\\';\\s*delete|\\';\\s*insert"
      description: "SQL injection with command chaining"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)1=1|1'1|'or'1'='1"
      description: "SQL injection boolean bypass"
      severity: "HIGH"
      confidence_weight: 0.75
      false_positive_rate: 0.15
    - pattern: "(?i)exec\\s*\\(|execute\\s*\\("
      description: "SQL command execution"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)sp_|xp_cmdshell"
      description: "SQL Server stored procedure"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)load_file\\s*\\(|into\\s+outfile"
      description: "MySQL file operation"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)pg_sleep\\s*\\(|waitfor\\s+delay"
      description: "SQL time-based injection"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "redis://[^\\s]*:[^\\s]*@"
      description: "Redis connection with credentials"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "(?i)db_password[=:]\\s*['\"]?[^'\"\\s]+['\"]?"
      description: "Database password parameter"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.12

  # XSS and Code Injection Patterns (20+ patterns)
  injection_security:
    - pattern: "<script[^>]*>|javascript:|on\\w+\\s*="
      description: "Cross-site scripting vector"
      severity: "HIGH"
      confidence_weight: 0.75
      false_positive_rate: 0.15
    - pattern: "(?i)alert\\s*\\(|confirm\\s*\\(|prompt\\s*\\("
      description: "JavaScript injection payload"
      severity: "HIGH"
      confidence_weight: 0.70
      false_positive_rate: 0.20
    - pattern: "(?i)eval\\s*\\(|exec\\s*\\(|system\\s*\\("
      description: "Code execution function"
      severity: "CRITICAL"
      confidence_weight: 0.85
      false_positive_rate: 0.10
    - pattern: "<iframe[^>]*src\\s*="
      description: "Potential iframe injection"
      severity: "MEDIUM"
      confidence_weight: 0.65
      false_positive_rate: 0.20
    - pattern: "<object[^>]*>|<embed[^>]*>"
      description: "Object/embed tag injection"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.18
    - pattern: "(?i)document\\.cookie|document\\.domain"
      description: "DOM property access"
      severity: "MEDIUM"
      confidence_weight: 0.60
      false_positive_rate: 0.25
    - pattern: "(?i)window\\.location|location\\.href"
      description: "Location manipulation"
      severity: "MEDIUM"
      confidence_weight: 0.65
      false_positive_rate: 0.20
    - pattern: "(?i)innerHTML|outerHTML"
      description: "HTML injection vector"
      severity: "HIGH"
      confidence_weight: 0.70
      false_positive_rate: 0.18
    - pattern: "(?i)xmlhttprequest|xhr"
      description: "AJAX request pattern"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.30
    - pattern: "(?i)fetch\\s*\\(|axios\\."
      description: "Modern AJAX pattern"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.30
    - pattern: "(?i)settimeout\\s*\\(|setinterval\\s*\\("
      description: "Timer function usage"
      severity: "LOW"
      confidence_weight: 0.45
      false_positive_rate: 0.35
    - pattern: "(?i)importscripts\\s*\\("
      description: "Web Worker script import"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "(?i)postmessage\\s*\\("
      description: "Cross-origin messaging"
      severity: "MEDIUM"
      confidence_weight: 0.65
      false_positive_rate: 0.20
    - pattern: "data:text/html|data:text/javascript"
      description: "Data URI script injection"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.10

  # Certificate and SSL Patterns (15+ patterns)
  certificate_security:
    - pattern: "allowAllHostnameVerifier|ALLOW_ALL_HOSTNAME_VERIFIER"
      description: "Hostname verification bypass"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.03
    - pattern: "trustAllCerts|X509TrustManager.*checkServerTrusted"
      description: "Certificate trust bypass"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.02
    - pattern: "RSA.*512|DSA.*512"
      description: "Weak key size"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "SHA1|MD5"
      description: "Weak hash algorithm"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)cert[_-]?pinning[=:]\\s*false"
      description: "Certificate pinning disabled"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)ssl[_-]?verify[=:]\\s*false"
      description: "SSL verification disabled"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)ignore[_-]?ssl[_-]?errors[=:]\\s*true"
      description: "SSL error ignoring enabled"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "X509Certificate\\[\\]\\s*\\{\\s*\\}"
      description: "Empty certificate array"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "TrustManager\\[\\]\\s*\\{\\s*new"
      description: "Custom trust manager"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "SSLContext\\.getInstance\\(\"SSL\"\\)"
      description: "Weak SSL context"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.08
    - pattern: "(?i)cert[_-]?validation[=:]\\s*false"
      description: "Certificate validation disabled"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)hostname[_-]?verification[=:]\\s*false"
      description: "Hostname verification disabled"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08

  # Privacy and Data Leakage Patterns (15+ patterns)
  privacy_security:
    - pattern: "ssn[=:]\\s*['\"]?\\d{3}-?\\d{2}-?\\d{4}['\"]?"
      description: "Social Security Number"
      severity: "CRITICAL"
      confidence_weight: 0.95
      false_positive_rate: 0.02
    - pattern: "email[=:]\\s*['\"]?[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}['\"]?"
      description: "Email address"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "\\b4\\d{15}\\b|\\b5[1-5]\\d{14}\\b|\\b3[47]\\d{13}\\b"
      description: "Credit card number pattern"
      severity: "CRITICAL"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)phone[=:]\\s*['\"]?\\+?[0-9\\s\\-\\(\\)]{10,}['\"]?"
      description: "Phone number"
      severity: "MEDIUM"
      confidence_weight: 0.65
      false_positive_rate: 0.20
    - pattern: "(?i)address[=:]\\s*['\"]?[^'\"\\r\\n]{20,}['\"]?"
      description: "Physical address"
      severity: "MEDIUM"
      confidence_weight: 0.60
      false_positive_rate: 0.25
    - pattern: "(?i)iban[=:]\\s*['\"]?[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}[A-Z0-9]{0,16}['\"]?"
      description: "International Bank Account Number"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.05
    - pattern: "(?i)passport[=:]\\s*['\"]?[A-Z0-9]{6,9}['\"]?"
      description: "Passport number"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)license[=:]\\s*['\"]?[A-Z0-9\\-]{8,20}['\"]?"
      description: "Driver's license number"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.12
    - pattern: "(?i)user[_-]?id[=:]\\s*['\"]?[0-9a-fA-F\\-]{8,}['\"]?"
      description: "User identifier"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.30
    - pattern: "(?i)device[_-]?id[=:]\\s*['\"]?[0-9a-fA-F\\-]{8,}['\"]?"
      description: "Device identifier"
      severity: "MEDIUM"
      confidence_weight: 0.65
      false_positive_rate: 0.20
    - pattern: "(?i)location[=:]\\s*['\"]?[-+]?[0-9]*\\.?[0-9]+,\\s*[-+]?[0-9]*\\.?[0-9]+['\"]?"
      description: "GPS coordinates"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08

  # Additional Comprehensive Security Patterns (40+ more patterns)
  network_protocols:
    - pattern: "ftp://|telnet://|rsh://|rlogin://"
      description: "Insecure network protocol"
      severity: "HIGH"
      confidence_weight: 0.90
      false_positive_rate: 0.02
    - pattern: "ldap://[^s]"
      description: "Insecure LDAP connection"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.05
    - pattern: "smtp://[^s]|pop3://[^s]|imap://[^s]"
      description: "Insecure email protocol"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.08
    - pattern: "snmp://|tftp://"
      description: "Insecure management protocol"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "rtsp://|rtmp://"
      description: "Media streaming protocol"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.25

  crypto_vulnerabilities:
    - pattern: "ECB|Electronic Codebook"
      description: "Weak encryption mode"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.05
    - pattern: "PKCS#1 v1\\.5|RSA/ECB/PKCS1Padding"
      description: "Vulnerable padding scheme"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.08
    - pattern: "Random\\(\\)|Math\\.random\\(\\)"
      description: "Weak random number generation"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "(?i)des[_-]?key|3des[_-]?key"
      description: "Weak encryption key type"
      severity: "HIGH"
      confidence_weight: 0.85
      false_positive_rate: 0.08
    - pattern: "(?i)md5[_-]?hash|sha1[_-]?hash"
      description: "Weak hashing algorithm"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.10

  mobile_specific:
    - pattern: "file://|content://|android_asset://"
      description: "Local file access scheme"
      severity: "MEDIUM"
      confidence_weight: 0.60
      false_positive_rate: 0.20
    - pattern: "intent://|market://|tel://|sms://"
      description: "Android intent scheme"
      severity: "LOW"
      confidence_weight: 0.50
      false_positive_rate: 0.25
    - pattern: "debuggable\\s*=\\s*['\"]?true['\"]?"
      description: "Debug mode enabled"
      severity: "MEDIUM"
      confidence_weight: 0.80
      false_positive_rate: 0.10
    - pattern: "(?i)deeplink[=:]|custom[_-]?scheme[=:]"
      description: "Deep link configuration"
      severity: "MEDIUM"
      confidence_weight: 0.70
      false_positive_rate: 0.15
    - pattern: "(?i)webview[_-]?debug[=:]\\s*true"
      description: "WebView debugging enabled"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.12

  backup_recovery:
    - pattern: "allowBackup\\s*=\\s*['\"]?true['\"]?"
      description: "App backup allowed"
      severity: "MEDIUM"
      confidence_weight: 0.75
      false_positive_rate: 0.12
    - pattern: "extractNativeLibs\\s*=\\s*['\"]?true['\"]?"
      description: "Native library extraction allowed"
      severity: "LOW"
      confidence_weight: 0.60
      false_positive_rate: 0.15
    - pattern: "(?i)backup[_-]?key[=:]\\s*['\"]?[A-Za-z0-9]+['\"]?"
      description: "Backup encryption key"
      severity: "HIGH"
      confidence_weight: 0.80
      false_positive_rate: 0.10

# MASVS Control Mappings
masvs_controls:
  MSTG-NETWORK-1:
    description: "Network requests use secure communication"
    patterns: ["http_security"]
    severity_threshold: "HIGH"
  MSTG-NETWORK-2:
    description: "TLS settings are properly configured"
    patterns: ["certificate_security"]
    severity_threshold: "MEDIUM"
  MSTG-CRYPTO-1:
    description: "Strong cryptography is used"
    patterns: ["crypto_vulnerabilities"]
    severity_threshold: "HIGH"
  MSTG-AUTH-1:
    description: "Authentication mechanisms are secure"
    patterns: ["authentication"]
    severity_threshold: "HIGH"
  MSTG-CODE-8:
    description: "Code injection vulnerabilities are mitigated"
    patterns: ["injection_security"]
    severity_threshold: "CRITICAL"

# Risk Assessment Configuration
risk_assessment:
  severity_weights:
    CRITICAL: 1.0
    HIGH: 0.8
    MEDIUM: 0.6
    LOW: 0.4
    INFO: 0.2
  
  confidence_thresholds:
    high_confidence: 0.85
    medium_confidence: 0.70
    low_confidence: 0.50
  
  false_positive_adjustments:
    conservative: 0.9  # Reduce confidence by 10% for conservative analysis
    standard: 1.0      # No adjustment
    aggressive: 1.1    # Increase confidence by 10% for aggressive analysis

# Pattern Reliability Database
pattern_reliability:
  learning_enabled: true
  calibration_threshold: 100  # Minimum samples before calibration
  accuracy_target: 0.95      # Target accuracy for pattern reliability
  
  default_reliability:
    new_pattern: 0.70
    validated_pattern: 0.90
    expert_reviewed: 0.95 